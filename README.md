# TGS Gap filler

A gap filling tool that uses long reads generated by thild-generation-sequence techniques (Pacbio, Oxford nanopore, etc) to fill N-gap in the genome assembly.

- Both raw reads and error-corrected reads can be used as input .

- If additional NGS short reads are available, it polishes raw TGS reads by calling Pilon .

## How to install

### Download 
```
git clone  https://github.com/BGI-Qingdao/TGSGapFiller.git YOUR-INSTALL-DIR
```

### Compile

#### prepare minimap2

- If you already have a minimap2 installed, you can link it here

```
rm -rf YOUR-INSTALL-DIR/minimap2
ln -s MINIMAP2-PATH YOUR-INSTALL-DIR/
```
- Otherwise you need to download it by :

```
cd YOUR-INSTALL-DIR
git submodule init
git submodule update
```

#### compile

```
cd YOUR-INSTALL-DIR/main_src_ont
make
```

## Usage 


### version without error correction 

- cp YOUR-INSTALL-DIR/pipeline/pipeline.sh into your-working-directory
- edit pipeline.sh for your project
- run pipeline.sh

### version with error correction

- cp YOUR-INSTALL-DIR/pipeline/pipeline_polish.sh into your-working-directory
- edit pipeline_polish.sh for your project
- run pipeline.sh

## Output

- your-prefix.scaff_seq 
    - this is the final sequence after gap filling
- your-prefix.gap_fill_details
    - details about how the final sequence was assemblied 

### format of your-prefix.gap_fill_details

#### a example :

```
>scaffold_1
1	1000	S	1000	2000
1001	1010	N
1011	1100	S	2201	2290
1101	1110	F
1111	1200	S	2301	2390
>scaffold_2
......

```
#### detailed information

1. each scaffold name is followed by its data lines.
2. data line contains 3 or 5 columns and describes the source of a segments of the final sequence:
    - column 1 is the segment's first bp position at the final sequence.
    - column 2 is the segment's last bp position at the final sequence.
    - column 3 is the segment's type , 'S' , 'N' or 'F'.
        - 'S' means this segment is a segment of the input sequence and this line includes other 2 more columns :
            - column 4 is the segment's first bp position at the input sequence.
            - column 5 is the segment's last bp position at the input sequence.
        - 'N' means this segment is N area.
        - 'F' means this segment is a filled sequence from TGS reads .

